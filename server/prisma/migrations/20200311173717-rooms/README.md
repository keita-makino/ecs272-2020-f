# Migration `20200311173717-rooms`

This migration has been generated by keita-makino at 3/11/2020, 5:37:18 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Data" (
    "address" text  NOT NULL DEFAULT '',
    "id" SERIAL,
    "lat" Decimal(65,30)  NOT NULL DEFAULT 0,
    "lng" Decimal(65,30)  NOT NULL DEFAULT 0,
    "name" text  NOT NULL DEFAULT '',
    "room" integer  NOT NULL ,
    "type" integer  NOT NULL ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "public"."Room" (
    "id" SERIAL,
    "name" text  NOT NULL DEFAULT '',
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."User" DROP COLUMN "number",
DROP COLUMN "name",
ADD COLUMN "name" text  NOT NULL DEFAULT '';

ALTER TABLE "public"."Data" ADD FOREIGN KEY ("type")REFERENCES "public"."DataType"("id") ON DELETE RESTRICT  ON UPDATE CASCADE

ALTER TABLE "public"."Data" ADD FOREIGN KEY ("room")REFERENCES "public"."Room"("id") ON DELETE RESTRICT  ON UPDATE CASCADE

DROP TABLE "public"."InitialData";

DROP TABLE "public"."MainData";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200301220526-number..20200311173717-rooms
--- datamodel.dml
+++ datamodel.dml
@@ -3,39 +3,36 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgres://ojqgzezcrkkccv:413545d8bc9cfbeb322834d87f2369199c51d226e374dc06da6883681e1fa266@ec2-35-172-85-250.compute-1.amazonaws.com:5432/d23tt9hq4p0gh8"
+  // PostgreSQL URL
 }
 model DataType {
-  id          Int           @id
-  name        String        @default("")
-  initialData InitialData[]
-  mainData    MainData[]
+  id       Int    @id
+  name     String @default("")
+  mainData Data[]
 }
-model InitialData {
+model Data {
   address String   @default("")
   id      Int      @default(autoincrement()) @id
   lat     Float    @default(0)
   lng     Float    @default(0)
   name    String   @default("")
+  room    Room
   type    DataType
 }
-model MainData {
-  address String   @default("")
-  id      Int      @default(autoincrement()) @id
-  lat     Float    @default(0)
-  lng     Float    @default(0)
-  name    String   @default("")
-  type    DataType
+model User {
+  email    String @default("") @unique
+  id       Int    @default(autoincrement()) @id
+  name     String
+  password String @default("")
 }
-model User {
-  email    String  @default("") @unique
-  id       Int     @default(autoincrement()) @id
-  name     String?
-  number   Float   @default(0)
-  password String  @default("")
+model Room {
+  id   Int    @default(autoincrement()) @id
+  name String
+  data Data[]
 }
```


